<kf-shift-manager-toolbar
  [actionsDisabled]="selectedOrders().length === 0"
></kf-shift-manager-toolbar>
<p-table
  #dt
  [value]="orders()"
  [(selection)]="selectedOrders"
  [loading]="loading$ | async"
  (onFilter)="onFilter($event)"
  [globalFilterFields]="['billing.full_name', 'id']"
>
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 4rem">
        <p-tableHeaderCheckbox />
      </th>
      <th pSortableColumn="id">ID<p-sortIcon field="id" /></th>
      <th pSortableColumn="date_created">
        Datum<p-sortIcon field="date_created" />
      </th>
      <th pSortableColumn="billing.full_name">
        Name<p-sortIcon field="billing.full_name" />
      </th>
      <th>E-mail</th>
      <th>Kontaktp.</th>
      <th>Schicht</th>
      <th>Ticket</th>
      <th>Preis</th>
      <th pSortableColumn="status">
        Status
        <p-sortIcon field="status" />
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-order>
    <tr>
      <td><p-tableCheckbox [value]="order" /></td>
      <td>{{ order.id }}</td>
      <td>{{ order.date_created | dateFormat }}</td>
      <td>{{ order.billing.full_name }}</td>
      <td class="truncate-cell" [pTooltip]="findMainItem(order.line_items)">
        {{ order.billing.email }}
      </td>
      <td>{{ order.billing.billing_invite }}</td>
      <td class="truncate-cell" [pTooltip]="findMainItem(order.line_items)">
        {{ findMainItem(order.line_items) }}
      </td>
      <td>{{ findCrossItem(order.line_items) }}</td>
      <td>{{ order.total | currency: 'EUR' }}</td>
      <td>{{ order.status }}</td>
    </tr>
  </ng-template>
</p-table>

<div class="footer">
  Summe: {{ sumPrice | currency: 'EUR' }} ({{ filteredOrders().length }}
  Bestellungen)
</div>
