"use strict";(self.webpackChunkkonfusius=self.webpackChunkkonfusius||[]).push([[968],{7451:(A,l,_)=>{_.d(l,{L:()=>a});var s=_(98961),o=_(98244),m=_(7536),u=_(886),c=_(98607),t=_(46180),i=_(49410);class a{constructor(e,h){(0,s.A)(this,"_items",void 0),(0,s.A)(this,"_activeItemIndex",-1),(0,s.A)(this,"_activeItem",(0,o.vPA)(null)),(0,s.A)(this,"_wrap",!1),(0,s.A)(this,"_typeaheadSubscription",m.yU.EMPTY),(0,s.A)(this,"_itemChangesSubscription",void 0),(0,s.A)(this,"_vertical",!0),(0,s.A)(this,"_horizontal",void 0),(0,s.A)(this,"_allowedModifierKeys",[]),(0,s.A)(this,"_homeAndEnd",!1),(0,s.A)(this,"_pageUpAndDown",{enabled:!1,delta:10}),(0,s.A)(this,"_effectRef",void 0),(0,s.A)(this,"_typeahead",void 0),(0,s.A)(this,"_skipPredicateFn",n=>n.disabled),(0,s.A)(this,"tabOut",new u.B),(0,s.A)(this,"change",new u.B),this._items=e,e instanceof o.rOR?this._itemChangesSubscription=e.changes.subscribe(n=>this._itemsChanged(n.toArray())):(0,o.Hps)(e)&&(this._effectRef=(0,o.QZP)(()=>this._itemsChanged(e()),{injector:h}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){this._typeaheadSubscription.unsubscribe();const h=this._getItemsArray();return this._typeahead=new c.T(h,{debounceInterval:"number"==typeof e?e:void 0,skipPredicate:n=>this._skipPredicateFn(n)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(n=>{this.setActiveItem(n)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,h=10){return this._pageUpAndDown={enabled:e,delta:h},this}setActiveItem(e){const h=this._activeItem();this.updateActiveItem(e),this._activeItem()!==h&&this.change.next(this._activeItemIndex)}onKeydown(e){const h=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(d=>!e[d]||this._allowedModifierKeys.indexOf(d)>-1);switch(h){case i.T:return void this.tabOut.next();case i.D:if(this._vertical&&r){this.setNextItemActive();break}return;case i.U:if(this._vertical&&r){this.setPreviousItemActive();break}return;case i.R:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case i.L:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case i.H:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case i.E:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case i.b:if(this._pageUpAndDown.enabled&&r){const d=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(d>0?d:0,1);break}return;case i.P:if(this._pageUpAndDown.enabled&&r){const d=this._activeItemIndex+this._pageUpAndDown.delta,I=this._getItemsArray().length;this._setActiveItemByIndex(d<I?d:I-1,-1);break}return;default:return void((r||(0,t.h)(e,"shiftKey"))&&this._typeahead?.handleKey(e))}this._typeahead?.reset(),e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const h=this._getItemsArray(),n="number"==typeof e?e:h.indexOf(e);this._activeItem.set(h[n]??null),this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const h=this._getItemsArray();for(let n=1;n<=h.length;n++){const r=(this._activeItemIndex+e*n+h.length)%h.length;if(!this._skipPredicateFn(h[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,h){const n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(!n[e+=h])return;this.setActiveItem(e)}}_getItemsArray(){return(0,o.Hps)(this._items)?this._items():this._items instanceof o.rOR?this._items.toArray():this._items}_itemsChanged(e){this._typeahead?.setItems(e);const h=this._activeItem();if(h){const n=e.indexOf(h);n>-1&&n!==this._activeItemIndex&&(this._activeItemIndex=n,this._typeahead?.setCurrentSelectedItemIndex(n))}}}},73349:(A,l,_)=>{_.d(l,{M:()=>u});var s=_(98961),o=_(98244),m=_(37536);let u=(()=>{var c;class t{}return c=t,(0,s.A)(t,"\u0275fac",function(a){return new(a||c)}),(0,s.A)(t,"\u0275mod",o.$C({type:c})),(0,s.A)(t,"\u0275inj",o.G2t({imports:[m.M]})),t})()},83424:(A,l,_)=>{_.d(l,{S:()=>m});var s=_(98961),o=_(886);class m{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,i,a=!0,f){(0,s.A)(this,"_multiple",void 0),(0,s.A)(this,"_emitChanges",void 0),(0,s.A)(this,"compareWith",void 0),(0,s.A)(this,"_selection",new Set),(0,s.A)(this,"_deselectedToEmit",[]),(0,s.A)(this,"_selectedToEmit",[]),(0,s.A)(this,"_selected",void 0),(0,s.A)(this,"changed",new o.B),this._multiple=t,this._emitChanges=a,this.compareWith=f,i&&i.length&&(t?i.forEach(e=>this._markSelected(e)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(a=>this._markSelected(a));const i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...t){this._verifyValueAssignment(t),t.forEach(a=>this._unmarkSelected(a));const i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...t){this._verifyValueAssignment(t);const i=this.selected,a=new Set(t.map(e=>this._getConcreteValue(e)));t.forEach(e=>this._markSelected(e)),i.filter(e=>!a.has(this._getConcreteValue(e,a))).forEach(e=>this._unmarkSelected(e));const f=this._hasQueuedChanges();return this._emitChangeEvent(),f}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const i=this._hasQueuedChanges();return t&&this._emitChangeEvent(),i}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(t,i){if(this.compareWith){i=i??this._selection;for(let a of i)if(this.compareWith(t,a))return a;return t}return t}}}}]);